 <div class="field-analysis-container" *ngIf="fieldLevelChanges">
      <div class="analysis-header">
        <h3>üî¨ An√°lisis Detallado por Campo</h3>
        <p class="analysis-description">
          Comparaci√≥n granular campo por campo mostrando cambios espec√≠ficos en cada columna
        </p>
        <div class="analysis-stats">
          <div class="stat-badge">
            <strong>{{ getFieldCount() }}</strong> campos analizados
          </div>
          <div class="stat-badge changes">
            <strong>{{ getFieldsWithChanges() }}</strong> con cambios
          </div>
        </div>
      </div>

      <div class="fields-grid">
        <div 
          *ngFor="let fieldName of getFieldNames()" 
          class="field-card"
          [ngClass]="{ 'has-changes': hasFieldChanges(fieldName) }">
          
          <div class="field-header">
            <h4>{{ getFieldIcon(fieldName) }} {{ fieldName }}</h4>
            <span class="field-type">{{ getFieldType(fieldName) }}</span>
          </div>

          <div class="field-content">
            <!-- Informaci√≥n b√°sica del campo -->
            <div class="field-basic-info">
              <div class="info-row">
                <span class="label">Valores √∫nicos:</span>
                <span class="value">
                  {{ getFieldData(fieldName)?.unique_values_old || 0 }} ‚Üí 
                  {{ getFieldData(fieldName)?.unique_values_new || 0 }}
                  <span *ngIf="getUniqueValuesChange(fieldName) !== 0" 
                        class="change-indicator"
                        [ngClass]="getUniqueValuesChange(fieldName) > 0 ? 'positive' : 'negative'">
                    ({{ getUniqueValuesChange(fieldName) > 0 ? '+' : '' }}{{ getUniqueValuesChange(fieldName) }})
                  </span>
                </span>
              </div>
              
              <div class="info-row">
                <span class="label">Valores nulos:</span>
                <span class="value">
                  {{ getFieldData(fieldName)?.null_count_old || 0 }} ‚Üí 
                  {{ getFieldData(fieldName)?.null_count_new || 0 }}
                  <span *ngIf="getNullCountChange(fieldName) !== 0" 
                        class="change-indicator"
                        [ngClass]="getNullCountChange(fieldName) > 0 ? 'negative' : 'positive'">
                    ({{ getNullCountChange(fieldName) > 0 ? '+' : '' }}{{ getNullCountChange(fieldName) }})
                  </span>
                </span>
              </div>
            </div>

            <!-- Cambios detectados -->
            <div class="changes-section" *ngIf="hasFieldChanges(fieldName)">
              <h5>üîç Cambios Detectados:</h5>
              <div class="changes-list">
                <div *ngFor="let change of getAllChanges(fieldName)" 
                     class="change-item"
                     [ngClass]="change.type">
                  <div class="change-icon">{{ getChangeIcon(change.type) }}</div>
                  <div class="change-description">{{ change.description }}</div>
                </div>
              </div>
            </div>

            <!-- Estad√≠sticas espec√≠ficas por tipo de dato -->
            <div *ngIf="isNumericField(fieldName)" class="numeric-stats">
              <h5>üìä Estad√≠sticas Num√©ricas:</h5>
              <div class="stats-comparison">
                <div class="stats-column">
                  <h6>Archivo Anterior</h6>
                  <div class="stat-item">
                    <span class="stat-label">Media:</span>
                    <span class="stat-value">{{ getNumericStat(fieldName, 'mean', 'old') }}</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Mediana:</span>
                    <span class="stat-value">{{ getNumericStat(fieldName, 'median', 'old') }}</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Min - Max:</span>
                    <span class="stat-value">{{ getNumericStat(fieldName, 'min', 'old') }} - {{ getNumericStat(fieldName, 'max', 'old') }}</span>
                  </div>
                </div>
                <div class="stats-column">
                  <h6>Archivo Posterior</h6>
                  <div class="stat-item">
                    <span class="stat-label">Media:</span>
                    <span class="stat-value">{{ getNumericStat(fieldName, 'mean', 'new') }}</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Mediana:</span>
                    <span class="stat-value">{{ getNumericStat(fieldName, 'median', 'new') }}</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Min - Max:</span>
                    <span class="stat-value">{{ getNumericStat(fieldName, 'min', 'new') }} - {{ getNumericStat(fieldName, 'max', 'new') }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- An√°lisis de texto -->
            <div *ngIf="isTextField(fieldName)" class="text-stats">
              <h5>üìù An√°lisis de Texto:</h5>
              <div class="stats-comparison">
                <div class="stats-column">
                  <h6>Archivo Anterior</h6>
                  <div class="stat-item">
                    <span class="stat-label">Long. promedio:</span>
                    <span class="stat-value">{{ getTextStat(fieldName, 'avg_length', 'old') }} chars</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Long. m√°xima:</span>
                    <span class="stat-value">{{ getTextStat(fieldName, 'max_length', 'old') }} chars</span>
                  </div>
                </div>
                <div class="stats-column">
                  <h6>Archivo Posterior</h6>
                  <div class="stat-item">
                    <span class="stat-label">Long. promedio:</span>
                    <span class="stat-value">{{ getTextStat(fieldName, 'avg_length', 'new') }} chars</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Long. m√°xima:</span>
                    <span class="stat-value">{{ getTextStat(fieldName, 'max_length', 'new') }} chars</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Valores √∫nicos a√±adidos/eliminados -->
            <div *ngIf="hasUniqueValuesChanges(fieldName)" class="unique-values-changes">
              <h5>üîÑ Cambios en Valores √önicos:</h5>
              
              <div *ngIf="getAddedValues(fieldName).length > 0" class="values-section added">
                <h6>‚ûï Valores A√±adidos ({{ getAddedValuesCount(fieldName) }}):</h6>
                <div class="values-list">
                  <span *ngFor="let value of getAddedValues(fieldName)" class="value-tag added">{{ value }}</span>
                  <span *ngIf="getAddedValuesCount(fieldName) > getAddedValues(fieldName).length" class="more-indicator">
                    +{{ getAddedValuesCount(fieldName) - getAddedValues(fieldName).length }} m√°s...
                  </span>
                </div>
              </div>
              
              <div *ngIf="getRemovedValues(fieldName).length > 0" class="values-section removed">
                <h6>‚ûñ Valores Eliminados ({{ getRemovedValuesCount(fieldName) }}):</h6>
                <div class="values-list">
                  <span *ngFor="let value of getRemovedValues(fieldName)" class="value-tag removed">{{ value }}</span>
                  <span *ngIf="getRemovedValuesCount(fieldName) > getRemovedValues(fieldName).length" class="more-indicator">
                    +{{ getRemovedValuesCount(fieldName) - getRemovedValues(fieldName).length }} m√°s...
                  </span>
                </div>
              </div>
            </div>

            <!-- Mensaje si no hay cambios -->
            <div *ngIf="!hasFieldChanges(fieldName)" class="no-changes">
              ‚úÖ No se detectaron cambios significativos en este campo
            </div>
          </div>
        </div>
      </div>
    </div>
